<!DOCTYPE html>
<html>
<head>
    <title>control center</title>
    <style>
        body { font-family: system-ui; padding: 20px; }
        button { font-family: 18px; padding: 10px 20px; margin-bottom: 20px; }
        #status { margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <h2>coffee server controls</h2>
    <button id="startBtn">start coffee server</button>
    <p id="status"></p>
</body>
<script>
    const status = document.getElementById('status');
    const startBtn = document.getElementById('startBtn');

    startBtn.onclick = async() => {
        status.innerText = "starting..."
        try {
            // const cmd = `~/start-coffee.sh`
            // const cmd = `ssh athena@192.168.1.194 "bash ~/code/mini/local-coffee/start-coffee.sh"`
            // status.innerText = "ready for business";
            const res = await fetch('/start-coffee', { method: 'POST' });
            const text = await res.text();
            status.innerText = text;
        } catch(err) {
            console.error(err);
            status.innerText = "no coppi. sold out."
        }
    };

    const es = new EventSource('/events');
    es.onmessage = (e) => {
        try {
            const msg = JSON.parse(e.data);
            if(msg.type==='status') status.innerText = msg.message;
        }catch{}
    };
</script>
</html>